<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="description"
          content="Website Sistem Informasi Akademik Politeknik Astra. Silahkan gunakan NIM dan password Anda untuk login.">
    <meta name="keywords"
          content="SIA,Sistem,Politeknik Astra,PMA,Akademik,SSO,Polman,Polman Astra,Politeknik Manufaktur,Politeknik Manufaktur Astra,Pendidikan Astra,Astra Politeknik,Polytechnic Astra,Astra Polytechnic,Astratek,Astratech,Kampus Astra,Kampus Terbaik,Politeknik Terbaik,Politeknik Vokasi,Vokasi,Vokasi Terbaik">
    <meta name="author" content="Politeknik Astra">
    <meta name="viewport" content="width=device-width"/>
    <title>Siormawa</title>
    <link rel="shortcut icon" href="../Content/User/logo3.png">
    <link href="../Content/Plugins/bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="../Content/Plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="../Content../Content/jquery.fancybox.css" rel="stylesheet"/>
    <link href="../Content../Content/bootstrap-select.min.css" rel="stylesheet"/>
    <link href="../Content/Styles/Style.css" rel="stylesheet"/>
    <script src="../Content/Scripts/tether/tether.min.js"></script>
    <script src="../Content/Scripts/jquery-3.1.1.min.js"></script>
    <script src="../Content/Scripts/jquery-ui-1.12.1.min.js"></script>
    <script src="../Content/Plugins/bootstrap-4.0.0-alpha.6-dist/js/bootstrap.min.js"></script>

    <!--    Ini buat toogle-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script src="../Content/Plugins/Highcharts-5.0.14/code/highcharts.js"></script>
    <script src="../Content/Plugins/Highcharts-5.0.14/code/highcharts-more.js"></script>
    <script src="../Content/Plugins/Highcharts-5.0.14/code/modules/solid-gauge.js"></script>
    <script src="../Content/Plugins/Highcharts-5.0.14/code/modules/exporting.js"></script>
    <script src="../Content/Scripts/jquery.fancybox.pack.js"></script>
    <script src="../Content/Scripts/bootstrap-select.min.js"></script>
    <script src="../Content/Scripts/LetterAvatar.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
    <script type="text/javascript">
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })

        $(function () {
            $('[rel="tooltip"]').tooltip()
        })

        $(function () {
            $('[data-toggle="popover"]').popover()
        })

        function redirectNotifikasi() {
            window.location.href = 'Page_Notifikasi.aspx';
        }

        function sentValidation(input) {
            $(input).addClass('disabled');
            $(input).text('Mohon tunggu..');
        }

        function pageLoad(sender, args) {
            $('.selectpicker').selectpicker();
            katweKibsAvatar.init({
                dataChars: 2
            });
        }

        function refreshChart() {
            try {
                $('#chartNilai').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#chartKehadiran').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#chartJamMinus').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#chartPelanggaran').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-ketercapaianpertemuan').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-ketercapaianmateri').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-ketercapaianwadir').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-kehadiranmahasiswatingkat1').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-kehadiranmahasiswatingkat2').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-kehadiranmahasiswatingkat3').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            try {
                $('#container-kehadiranmahasiswawadir').highcharts().setSize(undefined, undefined, false);
            } catch (err) {
            }
            for (i = 1; i <= 10; i++) {
                try {
                    $('#container-kehadiranMataKuliah' + i).highcharts().setSize(undefined, undefined, false);
                } catch (err) {
                }
                try {
                    $('#container-ketercapaianMataKuliah' + i).highcharts().setSize(undefined, undefined, false);
                } catch (err) {
                }
            }
        }
    </script>
    <script src="../Content/Scripts/jquery.floatThead.js"></script>
    <style>
        .mce-branding-powered-by {
            display: none;
        }

        table {
            border-top: none;
            border-bottom: none;
            background-color: #FFF;
        }

        .table-striped tbody tr:nth-of-type(2n+1) {
            background-color: #FFF;
        }

        .table-striped tbody tr:nth-of-type(2n), thead {
            background-color: #ECECEC;
        }

        .table-striped tbody tr.pagination-ys {
            background-color: #FFF;
        }

        .highcharts-credits {
            display: none;
            height: 0px;
        }

        .loaderPMB {
            position: absolute;
            left: 50%;
            top: 25%;
            z-index: 1;
            border: 10px solid #f3f3f3; /* Light grey */
            border-top: 10px solid #3498db; /* Blue */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            grid-gap: 10px;
            padding: 10px;
        }

        .gallery img {
            text-align: center;
            width: auto;
            height: 190px;
            object-fit: cover;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .gallery .caption {
            margin-top: 5px;
            font-size: 14px;
            color: #666;
            text-align: center;
        }

        .photo-container {
            display: flex;
            flex-wrap: wrap;
        }

        .photo-item {
            position: relative;
            margin: 10px;
            width: 200px;
            height: 200px;
            overflow: hidden;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .delete-button {
            position: absolute;
            top: 10px;
            left: 20px;
            background-color: red;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: none;
        }

        .gallery-item:hover .delete-button {
            display: block;
        }
    </style>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: #333;
            color: #fff;
            font-size: 18px;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .notification.show {
            opacity: 1;
        }
    </style>
    <script src="../Scripts/tinymce/tinymce.min.js"></script>
</head>
<body class="scrollstyle2">
<div>
    <div class="polman-nav-static-top">
        <div class="float-left polman-adjust4">
            <div class="fa fa-bars fa-2x polman-adjust2" id="opennav" style="margin-right: 15px; cursor: pointer;"
                 aria-hidden="true"
                 onclick="changestate();"></div>
            <a href="#">
                <img src="../Content/Images/IMG_Logo_astratech.png"
                     style="height: 45px; margin-top: -10px; margin-left: 10px;"/>
            </a>
        </div>
        <div class="polman-menu">
            <nav class="nav justify-content-end" style="padding-top: 5px;">
                <b id="username1" style="position: absolute;margin-top: 10px;"></b>
                <span id="lastlogin"
                      style="font-size: 11px; margin-top: -2px; width: 500px; text-align: right;"><br><br></span>
            </nav>
        </div>
        <div class="polman-menu-bar">
            <div class="float-right">
                <div class="fa fa-bars fa-2x" style="margin-top: 9px; cursor: pointer;" aria-hidden="true"
                     data-toggle="collapse" data-target="#menu" aria-expanded="false" aria-controls="menu"></div>
            </div>
        </div>
        <div class="polman-notifikasi" onclick="redirectNotifikasi();">
            <div class="float-right">
                <div class="fa fa-envelope fa-2x" style="margin-top: 8px; margin-right: 15px; cursor: pointer;"
                     aria-hidden="true"></div>
                <span class="badge badge-pill badge-info polman-badge">
                        1
                    </span>
            </div>
        </div>
    </div>
    <div id="menu" class="polman-nav-static-right collapse scrollstyle2 polman-adjust5">
        <div id="accordion" role="tablist" aria-multiselectable="true">
            <div class="list-group">
                <a id="logoutLink" href="../Login/login.html" onclick="logout()" class="list-group-item list-group-item-action"
                   style="border-radius: 0px; border: none; padding-left: 23px; display: inherit; padding-top: 12px; padding-bottom: 12px;"><i
                        class='fa fa-sign-out fa-lg fa-pull-left'></i>Logout</a>
                <a id="dashboardLink" href='../index.html' class='mt-0 list-group-item list-group-item-action'
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-home fa-lg fa-pull-left'></i>Dashboard </a>
                <a id="eventLink" href='../Event/index.html' class='mt-0 list-group-item list-group-item-action '
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-calendar fa-lg fa-pull-left'></i>Event </a>
                <a id="userLink" href='../User/index.html' class='mt-0 list-group-item list-group-item-action polman-menu-active'
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px; background-color: #e6f0ff; '><i
                        class='fa fa-user-plus fa-lg fa-pull-left'></i>User </a>
                <a id="kandidatLink" href='../Kandidat/index.html' class='mt-0 list-group-item list-group-item-action'
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-users fa-lg fa-pull-left'></i>Kandidat MPM / BEM </a>
                <a id="informasiLink" href='../Informasi/index.html' class='mt-0 list-group-item list-group-item-action '
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-info-circle fa-lg fa-pull-left'></i>Informasi</a>
                <a id="organisasiLink" href='../Organisasi/index.html' class='mt-0 list-group-item list-group-item-action '
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-sitemap fa-lg fa-pull-left'></i>Organisasi</a>
                <a id="jabatanLink" href='../Jabatan/index.html' class='mt-0 list-group-item list-group-item-action '
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-handshake-o fa-lg fa-pull-left'></i>Jabatan</a>
                <a id="periodeLink" href='../Periode/index.html' class='mt-0 list-group-item list-group-item-action '
                   style='border-radius: 0px; border: none; padding-left: 22px; display: inherit; padding-top: 12px; padding-bottom: 12px;'><i
                        class='fa fa-hourglass fa-lg fa-pull-left'></i>Periode</a>
            </div>
        </div>
    </div>
    <div id="allcontent" class="polman-adjust5">
        <ol class="breadcrumb polman-breadcrumb">
            <li class="breadcrumb-item"><a href='http://localhost/sso' data-toggle="tooltip" data-placement="bottom"
                                           title="Menuju Halaman SSO">Sistem Informasi Ormawa</a></li>
            <li class="breadcrumb-item">Jabatan</li>
        </ol>
        <hr/>
        <div class="form-group">
            <div class="col-md-offset-2 col-ml-2">
                <a href="../Jabatan/create.html" type="button" class="btn btn-primary text-white" data-toggle="tooltip" data-placement="bottom" title="Tambah Data Jabatan"><i class="fa fa-plus"></i>
                    Tambah Baru
                </a>
            </div>
        </div>
        <div class="card">
            <!--<input type="submit" value="Tambah Baru" class="btn btn-primary" />-->
            <div class="card-header">
                <b class="card-title">Jabatan</b>
            </div>
            <div class="card-block">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="table responsive">
                            <table id="basic-datatables"
                                   class="table table-hover table-bordered table-condensed table-striped grid text-center">
                                <thead>
                                <tr>
                                    <th class="text-center" style="width: 19px"><b>No.</b></th>
                                    <th class="text-center"><b>Nama Jabatan</b></th>
                                    <th class="text-center" style="width: 120px"><b>Status</b></th>
                                    <th class="text-center" style="width: 100px"><b>Aksi</b></th>
                                </tr>
                                </thead>
                                <tbody id="table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br/>
    </div>
</div>

<script src="../Content/assets/vendor/apexcharts/apexcharts.min.js"></script>
<script src="../Content/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../Content/assets/vendor/chart.js/chart.min.js"></script>
<script src="../Content/assets/vendor/echarts/echarts.min.js"></script>
<script src="../Content/assets/vendor/quill/quill.min.js"></script>
<script src="../Content/assets/vendor/simple-datatables/simple-datatables.js"></script>
<script src="../Content/assets/vendor/php-email-form/validate.js"></script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<!-- Template Main JS File -->
<script src="../Content/assets/js/main.js"></script>
<script language="JavaScript">
    var url = 'http://localhost:8080/getJabatans';

    $(document).ready(function () {
        // Inisialisasi DataTables
        $('#basic-datatables').DataTable();

        // Mengambil data JSON
        $.getJSON(url, function (json) {
            var table = $('#basic-datatables').DataTable();
            var status = "";
            // Loop melalui data JSON dan tambahkan ke tabel
            for (var i = 0; i < json.length; i++) {

                if(json[i].status == "Aktif"){
                    status = '<div class="form-check form-switch d-flex justify-content-center" ><input type="checkbox" class="form-check-input" id="StatusSwitch' + json[i].idJabatan + '" onclick="fungsiswitch(' + json[i].idJabatan + ')" checked></div>'
                }else if(json[i].status == "Tidak Aktif"){
                    status = '<div class="form-check form-switch d-flex justify-content-center"><input type="checkbox" class="form-check-input" id="StatusSwitch' + json[i].idJabatan + '" onclick="fungsiswitch(' + json[i].idJabatan + ')"></div>'
                }

                var rowData = [
                    i + 1,
                    json[i].nama,
                    status,
                    '<a href="../Jabatan/update.html?id=' + json[i].idJabatan + '" data-toggle="tooltip" data-placement="bottom" title="Ubah Data Jabatan"><i class="fa fa-pencil-square-o">&nbsp&nbsp</i></a>' +
                    '<a href="" data-id="' + json[i].idJabatan + '" onclick="deleteData(' + json[i].idJabatan + ')" data-toggle="tooltip" data-placement="bottom" title="Hapus Data Jabatan"><i class="fa fa-trash"></i></a>'
                ];

                table.row.add(rowData);
            }

            // Redraw tabel setelah menambahkan data
            table.draw();
        });
    });

    function deleteData(id) {
        var confirmDelete = confirm("Anda yakin ingin menghapus data ini?");

        if (confirmDelete) {
            $.ajax({
                url: "http://localhost:8080/deleteJabatan?id=" + id,
                success: function(response) {
                    alert("Data berhasil dihapus!");
                    location.reload();
                },
                error: function(xhr, status, error) {
                    alert("Terjadi kesalahan saat menghapus data.");
                }
            });
        }
    }

    function fungsiswitch(id) {
        var switchElement = document.getElementById(`StatusSwitch${id}`);

        if (switchElement.checked) {
            var konfirmasi = confirm("Apakah Anda yakin ingin mengaktifkan Jabatan?");
            console.log(konfirmasi);

            if (konfirmasi) {
                $.ajax({
                    url: "http://localhost:8080/aktifkanJabatan?id=" + id,
                    success: function(response) {
                    },
                    error: function(xhr, status, error) {
                        // Tampilkan pesan error jika gagal menghapus data
                        alert("Terjadi kesalahan");
                    }
                });
                switchElement.checked = true;
            } else {
                switchElement.checked = false;
            }
        } else {
            var konfirmasi = confirm("Apakah Anda yakin ingin menonaktifkan Jabatan?");
            console.log(konfirmasi);
            if (konfirmasi) {
                $.ajax({
                    url: "http://localhost:8080/nonaktifkanJabatan?id=" + id,
                    success: function(response) {
                    },
                    error: function(xhr, status, error) {
                        alert("Terjadi kesalahan");
                    }
                });
                switchElement.checked = false;
            } else {
                switchElement.checked = true;
            }
        }
    }

    function changestate(param) {
        if (param == "open") {
            $(".polman-adjust5").css("marginLeft", "0px");
            $(".hidemenu").css("visibility", "visible");
            $(".headcol").css("marginLeft", "255px");
            $("#opennav").attr("onclick", "changestate()");
        } else {
            $(".polman-adjust5").css("marginLeft", "-250px");
            $(".hidemenu").css("visibility", "hidden");
            $(".headcol").css("marginLeft", "5px");
            //get id opennav and change to closed
            $("#opennav").attr("onclick", "changestate('open')");
        }
    }

    function hidemenu() {
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            success: function (r) {
                changestate(r.d);
            },
            failure: function (response) {
                alert("Terjadi Kesalahan");
            }
        });
    }

    function getCookieValue(cookieName) {
        var name = cookieName + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var cookieArray = decodedCookie.split(";");

        for (var i = 0; i < cookieArray.length; i++) {
            var cookie = cookieArray[i];
            while (cookie.charAt(0) === " ") {
                cookie = cookie.substring(1);
            }
            if (cookie.indexOf(name) === 0) {
                return cookie.substring(name.length, cookie.length);
            }
        }

        return "";
    }

    // Mengambil nilai cookie "nama" dan "role"
    var nama = getCookieValue("nama");
    var role = getCookieValue("role");

    document.getElementById("username1").textContent = nama + " (" + role + ")";

    function deleteCookie(cookieName) {
        document.cookie = cookieName + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    }

    var role = getCookieValue("role"); // Fungsi untuk mendapatkan peran dari cookie
    console.log(role);

    // Daftar elemen sidebar yang perlu diubah berdasarkan peran
    var sidebarElements = [
        { elementId: "logoutLink", allowedRoles: ["Admin", "Ormawa", "Super Admin", "MAHASISWA"] },
        { elementId: "dashboardLink", allowedRoles: ["Admin", "Ormawa", "Super Admin", "MAHASISWA"] },
        { elementId: "eventLink", allowedRoles: ["Admin", "Super Admin"] },
        { elementId: "userLink", allowedRoles: ["Admin"] },
        { elementId: "kandidatLink", allowedRoles: ["Admin"] },
        { elementId: "informasiLink", allowedRoles: ["Admin", "Ormawa", "Super Admin"] },
        { elementId: "organisasiLink", allowedRoles: ["Admin", "Ormawa", "Super Admin"] },
        { elementId: "jabatanLink", allowedRoles: ["Super Admin"]},
        { elementId: "periodeLink", allowedRoles: ["Super Admin"]}
    ];

    // Menampilkan atau menyembunyikan elemen sidebar berdasarkan peran
    for (var i = 0; i < sidebarElements.length; i++) {
        var element = document.getElementById(sidebarElements[i].elementId);
        if (element && sidebarElements[i].allowedRoles.includes(role)) {
            element.style.display = "block"; // Menampilkan elemen sidebar
        } else {
            element.style.display = "none"; // Menyembunyikan elemen sidebar
        }
    }

    function logout() {
        deleteCookie("nama");
        deleteCookie("role");
        deleteCookie("nim");
        deleteCookie("prodi");
        window.location.href = "../Login/login.html";
    }

    /*function checkCookie() {
        var cookieExists = document.cookie.indexOf("namaCookie") !== -1; // Ganti "namaCookie" dengan nama cookie yang ingin Anda periksa

        if (!cookieExists) {
            window.location.href = "../Login/login.html"; // Ganti "halaman-login.html" dengan URL halaman login yang Anda inginkan
        }
    }
    // Panggil fungsi checkCookie saat halaman dimuat
    document.addEventListener("DOMContentLoaded", function() {
        checkCookie();
    });*/
</script>
</body>
</html>